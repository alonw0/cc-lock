<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'" />
  <title>CCLock</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      font-size: 13px;
      background: #ffffff;
      color: #1a1a1a;
      width: 260px;
      overflow: hidden;
      user-select: none;
    }

    #app {
      display: flex;
      flex-direction: column;
    }

    .section {
      padding: 8px 10px;
    }

    .divider {
      height: 1px;
      background: #e5e7eb;
    }

    .section-label {
      font-size: 11px;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 5px;
    }

    /* Status section */
    #status-section {
      padding: 10px 10px 8px;
    }

    .status-row {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      font-weight: 500;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .status-dot.green  { background: #22c55e; }
    .status-dot.red    { background: #ef4444; }
    .status-dot.yellow { background: #eab308; }
    .status-dot.gray   { background: #9ca3af; }

    .status-label.green  { color: #15803d; }
    .status-label.red    { color: #dc2626; }
    .status-label.yellow { color: #a16207; }
    .status-label.gray   { color: #6b7280; }

    .status-meta {
      margin-top: 4px;
      padding-left: 14px;
      font-size: 11px;
      color: #6b7280;
      line-height: 1.5;
    }

    .status-meta .countdown {
      font-variant-numeric: tabular-nums;
      font-family: "SF Mono", Consolas, "Courier New", monospace;
    }

    .status-meta .bypass-warn {
      color: #d97706;
    }

    /* Daemon button */
    #daemon-section {
      display: none;
    }

    #daemon-section .daemon-hint {
      font-size: 11px;
      color: #6b7280;
      margin-top: 4px;
    }

    #daemon-error {
      display: none;
      font-size: 11px;
      color: #dc2626;
      margin-top: 4px;
    }

    /* Quick lock */
    #quick-lock-section {
      display: none;
    }

    .button-row {
      display: flex;
      gap: 5px;
    }

    .lock-btn {
      flex: 1;
      padding: 4px 0;
      border: 1px solid #d1d5db;
      border-radius: 5px;
      background: #f9fafb;
      color: #374151;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.1s;
    }

    .lock-btn:hover {
      background: #f3f4f6;
      border-color: #9ca3af;
    }

    .lock-btn:active {
      background: #e5e7eb;
    }

    /* Usage */
    #usage-section {
      display: none;
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: #374151;
      padding: 1px 0;
    }

    .stat-value {
      font-variant-numeric: tabular-nums;
      font-family: "SF Mono", Consolas, "Courier New", monospace;
      color: #111827;
    }

    /* Schedules */
    #schedules-section {
      display: none;
    }

    .schedule-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 3px 0;
    }

    .schedule-info {
      flex: 1;
      min-width: 0;
    }

    .schedule-name {
      font-size: 12px;
      color: #111827;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .schedule-time {
      font-size: 10px;
      color: #9ca3af;
    }

    .schedule-toggle {
      width: 14px;
      height: 14px;
      cursor: pointer;
      flex-shrink: 0;
      margin-left: 8px;
      accent-color: #3b82f6;
    }

    /* Footer */
    .footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 6px 10px;
    }

    .hint {
      font-size: 10px;
      color: #9ca3af;
    }

    #quit-btn, #start-daemon-btn {
      padding: 3px 8px;
      border: 1px solid #d1d5db;
      border-radius: 5px;
      background: #f9fafb;
      color: #374151;
      font-size: 11px;
      cursor: pointer;
    }

    #quit-btn:hover, #start-daemon-btn:hover {
      background: #f3f4f6;
    }

    #start-daemon-btn {
      width: 100%;
      margin-bottom: 2px;
    }

    /* Settings row */
    .settings-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 12px;
      color: #374151;
      cursor: pointer;
    }

    #login-item-toggle {
      width: 14px;
      height: 14px;
      cursor: pointer;
      accent-color: #3b82f6;
    }
  </style>
</head>
<body>
  <div id="app">

    <!-- Status -->
    <div class="section" id="status-section">
      <div class="status-row">
        <div class="status-dot gray" id="status-dot"></div>
        <span class="status-label gray" id="status-label">Connecting…</span>
      </div>
      <div class="status-meta" id="status-meta"></div>
    </div>

    <div class="divider"></div>

    <!-- Daemon section (disconnected) -->
    <div class="section" id="daemon-section">
      <button id="start-daemon-btn">Start Daemon</button>
      <div id="daemon-error"></div>
    </div>

    <!-- Quick lock (unlocked only) -->
    <div class="section" id="quick-lock-section">
      <div class="section-label">Quick Lock</div>
      <div class="button-row">
        <button class="lock-btn" data-minutes="30">30m</button>
        <button class="lock-btn" data-minutes="60">1h</button>
        <button class="lock-btn" data-minutes="120">2h</button>
        <button class="lock-btn" data-minutes="240">4h</button>
      </div>
    </div>

    <div class="divider" id="divider-usage" style="display:none"></div>

    <!-- Usage -->
    <div class="section" id="usage-section">
      <div class="section-label">Usage</div>
      <div class="stat-row">
        <span>Today:</span>
        <span class="stat-value" id="today-usage">—</span>
      </div>
      <div class="stat-row">
        <span>This week:</span>
        <span class="stat-value" id="week-usage">—</span>
      </div>
    </div>

    <div class="divider" id="divider-schedules" style="display:none"></div>

    <!-- Schedules -->
    <div class="section" id="schedules-section">
      <div class="section-label">Schedules</div>
      <div id="schedules-list"></div>
    </div>

    <div class="divider"></div>

    <!-- Settings -->
    <div class="section">
      <label class="settings-row">
        <span>Start on login</span>
        <input type="checkbox" id="login-item-toggle" />
      </label>
    </div>

    <div class="divider"></div>

    <!-- Footer -->
    <div class="footer">
      <span class="hint">cc-lock unlock (to bypass)</span>
      <button id="quit-btn">Quit</button>
    </div>

  </div>
  <script src="app.js"></script>
</body>
</html>
